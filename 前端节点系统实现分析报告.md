# å‰ç«¯èŠ‚ç‚¹ç³»ç»Ÿå®ç°å…¨é¢åˆ†ææŠ¥å‘Š

> **åˆ†ææ—¥æœŸï¼š** 2025-11-11  
> **åˆ†æå¯¹è±¡ï¼š** n8n SASA å¹³å°å‰ç«¯èŠ‚ç‚¹ç³»ç»Ÿ  
> **åˆ†æèŒƒå›´ï¼š** èŠ‚ç‚¹é€‰æ‹©å™¨ã€èŠ‚ç‚¹Storeã€å·¥ä½œæµç¼–è¾‘å™¨ã€å·¥ä½œç©ºé—´éš”ç¦»  
> **çŠ¶æ€ï¼š** é˜¶æ®µ 5.3ï¼ˆèŠ‚ç‚¹åŠ¨æ€åŒ–è¿›è¡Œä¸­ï¼‰

---

## ç›®å½•

1. [æ‰§è¡Œæ‘˜è¦](#æ‰§è¡Œæ‘˜è¦)
2. [1. èŠ‚ç‚¹é€‰æ‹©å™¨åˆ†æ](#1-èŠ‚ç‚¹é€‰æ‹©å™¨åˆ†æ)
3. [2. èŠ‚ç‚¹ç±»å‹Storeåˆ†æ](#2-èŠ‚ç‚¹ç±»å‹storeåˆ†æ)
4. [3. å·¥ä½œæµç¼–è¾‘å™¨é›†æˆ](#3-å·¥ä½œæµç¼–è¾‘å™¨é›†æˆ)
5. [4. èŠ‚ç‚¹ä»·æ ¼ä¸è®¡è´¹](#4-èŠ‚ç‚¹ä»·æ ¼ä¸è®¡è´¹)
6. [5. å·¥ä½œç©ºé—´åˆ‡æ¢](#5-å·¥ä½œç©ºé—´åˆ‡æ¢)
7. [ç¼ºå¤±åŠŸèƒ½æ¸…å•](#ç¼ºå¤±åŠŸèƒ½æ¸…å•)
8. [æ”¹è¿›å»ºè®®](#æ”¹è¿›å»ºè®®)

---

## æ‰§è¡Œæ‘˜è¦

### å½“å‰å®ç°çŠ¶æ€

| ç»„ä»¶ | å®ç°è¿›åº¦ | çŠ¶æ€ | å¤‡æ³¨ |
|------|---------|------|------|
| **èŠ‚ç‚¹é€‰æ‹©å™¨** | 90% | éƒ¨åˆ†å®Œæˆ | åŸºç¡€UIå­˜åœ¨ï¼Œç¼ºå°‘Badgeæ˜¾ç¤º |
| **èŠ‚ç‚¹Store** | 85% | éƒ¨åˆ†å®Œæˆ | APIé›†æˆå®Œæˆï¼Œä½†æœªæ­£ç¡®ä¿å­˜/æ˜¾ç¤ºsource |
| **å¯ç”¨èŠ‚ç‚¹API** | 95% | å®Œæˆ | AvailableNodesControllerå·²å®ç° |
| **å·¥ä½œç©ºé—´éš”ç¦»** | 70% | è¿›è¡Œä¸­ | åŸºç¡€å®ç°ï¼Œéœ€è¦å®Œå–„ |
| **èŠ‚ç‚¹ä»·æ ¼æ˜¾ç¤º** | 5% | æœªå¯åŠ¨ | éœ€è¦æ–°å¢åŠŸèƒ½ |
| **å·¥ä½œæµæˆæœ¬ä¼°ç®—** | 0% | æœªå¯åŠ¨ | å®Œå…¨ç¼ºå¤± |

### æ ¸å¿ƒå‘ç°

âœ… **å·²å®Œæˆï¼š**
- åç«¯ AvailableNodesController API å®Œæ•´å®ç°
- nodeTypes.store.ts å·²æ”¯æŒä»APIåŠ è½½å¹³å°å’Œè‡ªå®šä¹‰èŠ‚ç‚¹
- èŠ‚ç‚¹æ¥æºï¼ˆsourceï¼‰æ•°æ®å·²ä»åç«¯ä¼ é€’åˆ°å‰ç«¯
- å·¥ä½œç©ºé—´éš”ç¦»åŸºç¡€æ¶æ„å­˜åœ¨

âŒ **å­˜åœ¨é—®é¢˜ï¼š**
1. **Source Badge æœªæ˜¾ç¤º** - NodeItem.vue æœªå®ç°èŠ‚ç‚¹æ¥æºBadge
2. **Sourceä¿¡æ¯æœªæ­£ç¡®ä¿ç•™** - convertAvailableNodeToDescription ä¸­sourceè¢«æ·»åŠ ä½†æœªæ­£ç¡®æµå‘UI
3. **èŠ‚ç‚¹ä»·æ ¼åŠŸèƒ½ç¼ºå¤±** - æ²¡æœ‰ä»·æ ¼å­—æ®µã€ä»·æ ¼æ˜¾ç¤ºã€æˆæœ¬ä¼°ç®—
4. **å·¥ä½œç©ºé—´åˆ‡æ¢æœªè§¦å‘èŠ‚ç‚¹åˆ·æ–°** - æ²¡æœ‰Watchç›‘å¬ currentWorkspaceId
5. **èŠ‚ç‚¹æ•°æ®ä¸å®Œæ•´** - platformå’ŒcustomèŠ‚ç‚¹ç¼ºå°‘å®Œæ•´çš„ nodeDefinition æ•°æ®

---

## 1. èŠ‚ç‚¹é€‰æ‹©å™¨åˆ†æ

### 1.1 ç»„ä»¶ç»“æ„

**ä¸»è¦æ–‡ä»¶ï¼š**
```
packages/frontend/editor-ui/src/features/shared/nodeCreator/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ NodeCreator.vue              # ä¸»å®¹å™¨ï¼ˆç©ºç™½ï¼‰
â”‚   â”œâ”€â”€ Panel/NodesListPanel.vue      # èŠ‚ç‚¹åˆ—è¡¨é¢æ¿
â”‚   â””â”€â”€ ItemTypes/
â”‚       â”œâ”€â”€ NodeItem.vue              # å•ä¸ªèŠ‚ç‚¹é¡¹ï¼ˆç¼ºBadgeï¼‰
â”‚       â”œâ”€â”€ CategoryItem.vue          # åˆ†ç±»é¡¹
â”‚       â”œâ”€â”€ CommunityNodeItem.vue     # ç¤¾åŒºèŠ‚ç‚¹ï¼ˆæœ‰Badgeï¼‰
â”‚       â””â”€â”€ ...
â”œâ”€â”€ nodeCreator.store.ts             # Store
â””â”€â”€ composables/
    â”œâ”€â”€ useActionsGeneration.ts       # åŠ¨ä½œç”Ÿæˆ
    â””â”€â”€ useDynamicAINodes.ts          # åŠ¨æ€AIèŠ‚ç‚¹
```

### 1.2 å®ç°ç°çŠ¶

#### âœ… å·²å®ç°

1. **Tab ç»“æ„åŸºæœ¬å­˜åœ¨**
   - NodesListPanel.vue ä¸­å­˜åœ¨Tabåˆ‡æ¢é€»è¾‘
   - æ”¯æŒå¤šä¸ªè§†å›¾ï¼ˆè§¦å‘å™¨ã€å¸¸è§„ã€AIç­‰ï¼‰

2. **èŠ‚ç‚¹æœç´¢åŠŸèƒ½**
   - nodeCreator.utils.ts ä¸­åŒ…å«æœç´¢é€»è¾‘
   - SearchBar.vue å·²å®ç°

3. **åŠ¨æ€AIèŠ‚ç‚¹**
   - useDynamicAINodes.ts æ”¯æŒåŠ è½½åŠ¨æ€AI Chat ModelèŠ‚ç‚¹

#### âŒ ç¼ºå¤±åŠŸèƒ½

1. **èŠ‚ç‚¹æ¥æºBadge**
   ```vue
   <!-- NodeItem.vue ç¬¬56è¡Œå¼€å§‹çš„description computed -->
   <!-- å®Œå…¨æ²¡æœ‰æ£€æŸ¥æˆ–æ˜¾ç¤ºsourceä¿¡æ¯ -->
   const description = computed<string>(() => {
       // ... ä»£ç 
       // ç¼ºå°‘ï¼šæ˜¾ç¤º [å†…ç½®] [å¹³å°] [è‡ªå®šä¹‰] Badge
   });
   ```

2. **æŒ‰æ¥æºåˆ†ç±»çš„Tab**
   è®¾è®¡æ–‡æ¡£ä¸­æåˆ°çš„"åŸºç¡€èŠ‚ç‚¹""æ‰©å±•èŠ‚ç‚¹""æˆ‘çš„èŠ‚ç‚¹"ä¸‰ä¸ªTabåœ¨ä»£ç ä¸­æœªå®ç°

3. **è‡ªå®šä¹‰èŠ‚ç‚¹ä¸Šä¼ å…¥å£**
   - è®¾è®¡æ–‡æ¡£ç¤ºæ„æœ‰"ä¸Šä¼ èŠ‚ç‚¹"æŒ‰é’®
   - å®é™…ä»£ç ä¸­æ— ç›¸å…³å®ç°

### 1.3 NodeItem.vue å½“å‰çŠ¶æ€

**æ–‡ä»¶ä½ç½®ï¼š** `/packages/frontend/editor-ui/src/features/shared/nodeCreator/components/ItemTypes/NodeItem.vue`

**å…³é”®å‘ç°ï¼š**
```typescript
// ç¬¬29è¡Œï¼šPropsæ¥å£ä¸­æ²¡æœ‰sourceç›¸å…³å­—æ®µ
export interface Props {
	nodeType: SimplifiedNodeType;
	subcategory?: string;
	active?: boolean;
}

// ç¬¬56-74è¡Œï¼šdescriptionè®¡ç®—ä¸­æ²¡æœ‰æ£€æŸ¥source
const description = computed<string>(() => {
	if (isCommunityNodePreview.value) { return props.nodeType.description; }
	// ... å…¶ä»–é€»è¾‘
	// ğŸ’¥ å®Œå…¨ç¼ºå°‘å¯¹sourceçš„å¤„ç†
});
```

**éœ€è¦çš„æ”¹è¿›ï¼š**
```typescript
// åº”è¯¥è¿™æ ·å®ç°
const nodeBadge = computed(() => {
	const source = props.nodeType.source; // éœ€è¦ä»SimplifiedNodeTypeè·å–
	if (source === 'builtin') return { text: 'å†…ç½®', type: 'info' };
	if (source === 'platform') return { text: 'å¹³å°', type: 'success' };
	if (source === 'custom') return { text: 'æˆ‘çš„', type: 'warning' };
	return null;
});
```

### 1.4 UI ç¼ºå¤±çš„Badgeæ˜¾ç¤º

**å½“å‰ï¼š** èŠ‚ç‚¹åªæ˜¾ç¤ºå›¾æ ‡å’Œåç§°
```
[å›¾æ ‡] Set
```

**åº”è¯¥ï¼š** èŠ‚ç‚¹æ˜¾ç¤ºæ¥æºBadge
```
[å›¾æ ‡] Set [å†…ç½®]
æˆ–
[å›¾æ ‡] GitHub [å¹³å°]
æˆ–
[å›¾æ ‡] MyCustomNode [æˆ‘çš„]
```

---

## 2. èŠ‚ç‚¹ç±»å‹Storeåˆ†æ

### 2.1 nodeTypes.store.ts å®ç°çŠ¶æ€

**æ–‡ä»¶ä½ç½®ï¼š** `/packages/frontend/editor-ui/src/app/stores/nodeTypes.store.ts`

### 2.2 æ•°æ®æµåˆ†æ

#### âœ… å·²å®Œæˆçš„æµç¨‹

```typescript
// è¡Œ 435-538: getNodeTypes() æ–¹æ³•å®Œæ•´å®ç°

// ç¬¬1æ­¥ï¼šåŠ è½½å†…ç½®èŠ‚ç‚¹ï¼ˆbuiltinï¼‰
const nodeTypes = await nodeTypesApi.getNodeTypes(rootStore.baseUrl);
const nodeTypesWithSource = nodeTypes.map((nodeType) => ({
	...nodeType,
	source: 'builtin' as const,  // âœ… æ·»åŠ source
}));
setNodeTypes(nodeTypesWithSource);
nodesBySource.value.set('builtin', nodeTypesWithSource);

// ç¬¬2æ­¥ï¼šåŠ è½½åŠ¨æ€AIèŠ‚ç‚¹
const { loadDynamicAIChatModels } = useDynamicAINodes();
const dynamicAINodes = await loadDynamicAIChatModels();
setNodeTypes(dynamicAINodes as INodeTypeDescription[]);

// ç¬¬3æ­¥ï¼šåŠ è½½å¯ç”¨èŠ‚ç‚¹ï¼ˆå¹³å° + è‡ªå®šä¹‰ï¼‰
const availableNodes = await availableNodesApi.getAvailableNodes(
	rootStore.restApiContext,
	workspaceId,
);

// ç¬¬4æ­¥ï¼šè½¬æ¢å’Œåˆ†ç±»
const platformNodes: INodeTypeDescription[] = [];
const customNodes: INodeTypeDescription[] = [];
for (const node of availableNodes) {
	const nodeDescription = convertAvailableNodeToDescription(node);
	// ... åˆ†ç±»é€»è¾‘
}
```

#### âŒ å­˜åœ¨çš„é—®é¢˜

1. **Sourceä¿¡æ¯æœªæ­£ç¡®ä¿ç•™**
   ```typescript
   // è¡Œ 336-387: convertAvailableNodeToDescription
   // âŒ é—®é¢˜ï¼šä¸ºplatformå’ŒcustomèŠ‚ç‚¹åˆ›å»ºçš„INodeTypeDescriptionä¸å®Œæ•´
   
   const nodeDescription: Partial<INodeTypeDescription> = {
       name: availableNode.nodeName,
       displayName: availableNode.nodeName,
       description: availableNode.description || '',
       version: availableNode.version ? parseFloat(availableNode.version) : 1,
       defaults: {
           name: availableNode.nodeName,
       },
       inputs: [NodeConnectionTypes.Main],
       outputs: [NodeConnectionTypes.Main],
       properties: [], // âŒ ç©ºæ•°ç»„ï¼
       group: ['transform'], // âŒ ç¡¬ç¼–ç ï¼
       // ...
   };
   
   // æ·»åŠ sourceï¼ˆä½†ä¼šä¸¢å¤±ï¼‰
   Object.assign(nodeDescription, { source: availableNode.source });
   ```

2. **setNodeTypes ä¸­sourceä¼šè¢«è¦†ç›–**
   ```typescript
   // è¡Œ 389-395: setNodeTypes
   const setNodeTypes = (newNodeTypes: INodeTypeDescription[] = []) => {
       const groupedNodeTypes = groupNodeTypesByNameAndType(newNodeTypes);
       // âš ï¸ groupNodeTypesByNameAndType å¯èƒ½ä¼šåˆ é™¤sourceå­—æ®µ
       nodeTypes.value = {
           ...nodeTypes.value,
           ...groupedNodeTypes,
       };
   };
   ```

3. **nodesBySource åœ¨æŸäº›æƒ…å†µä¸‹æœªæ­£ç¡®ä½¿ç”¨**
   ```typescript
   // è¡Œ 50: nodesBySource è¢«å®šä¹‰
   const nodesBySource = ref<Map<string, INodeTypeDescription[]>>(new Map());
   
   // ä½†è¿™ä¸ªæ•°æ®ä»æœªåœ¨computedä¸­ç”¨äºç”ŸæˆvisibleNodeTypes
   const visibleNodeTypes = computed(() => {
       const beforeFilter = allLatestNodeTypes.value  // âŒ ä¸ä»nodesBySourceè·å–
           .concat(officialCommunityNodeTypes.value)
           .concat(moduleEnabledNodeTypes.value);
   });
   ```

### 2.3 APIæ¥å£æ£€æŸ¥

**æ–‡ä»¶ä½ç½®ï¼š** `/packages/frontend/@n8n/rest-api-client/src/api/nodeTypes.ts`

**ç°çŠ¶ï¼š** åŸºç¡€APIå·²å®ç°

```typescript
export async function getNodeTypes(baseUrl: string) {
	return await fetchNodeTypesJsonWithRetry(baseUrl + 'types/nodes.json');
}

// âœ… å…¶ä»–APIéƒ½å­˜åœ¨ï¼Œä½†nodeTypes.tsä¸­æœªé›†æˆ"getAvailableNodes"
// åº”è¯¥åœ¨è¿™é‡Œæ·»åŠ ï¼š
export async function getAvailableNodes(
	context: IRestApiContext,
	workspaceId: string,
): Promise<AvailableNode[]> {
	return await makeRestApiRequest<AvailableNode[]>(
		context,
		'GET',
		'/available-nodes',
		{ workspaceId },
	);
}
```

**âœ… å·²æ­£ç¡®å®ç°ï¼š**
- `/available-nodes` - è·å–æ‰€æœ‰å¯ç”¨èŠ‚ç‚¹
- `/available-nodes/by-category` - æŒ‰åˆ†ç±»åˆ†ç»„
- `/available-nodes/unconfigured` - è·å–æœªé…ç½®çš„èŠ‚ç‚¹
- `/available-nodes/stats` - è·å–ç»Ÿè®¡ä¿¡æ¯
- `/available-nodes/builtin` - è·å–å†…ç½®èŠ‚ç‚¹

### 2.4 åç«¯AvailableNodesControlleræ£€æŸ¥

**æ–‡ä»¶ä½ç½®ï¼š** `/packages/cli/src/controllers/available-nodes.controller.ts`

**âœ… å®Œæ•´å®ç°ï¼š**

```typescript
@Get('/')
async getAvailableNodes(req, _res, @Query query) {
	const { workspaceId } = query;
	
	// 1. è·å–å†…ç½®èŠ‚ç‚¹
	const builtInNodes = Object.entries(knownNodes).map(([nodeKey, nodeInfo]) => ({
		// ...
		source: 'builtin' as const,
	}));
	
	// 2. è·å–å¹³å°èŠ‚ç‚¹
	const platformNodes = await this.platformNodeService.getAllNodes({
		enabled: true,
		isActive: true,
	});
	
	// 3. è·å–è‡ªå®šä¹‰èŠ‚ç‚¹
	const customNodes = await this.customNodeService.getWorkspaceNodes(workspaceId);
	
	// 4. åˆå¹¶å’Œè¿”å›
	const allNodes = [...builtInNodes, ...platformNodes, ...customNodes];
	
	// 5. æ ‡æ³¨é…ç½®çŠ¶æ€
	const configStatusMap = ...; // è·å–é…ç½®çŠ¶æ€
	const nodesWithStatus = allNodes.map(node => ({
		...node,
		isConfigured: configStatusMap.get(node.nodeKey),
	}));
	
	return nodesWithStatus;
}
```

**è¿”å›æ•°æ®ç»“æ„ï¼š**
```typescript
interface AvailableNode {
	nodeKey: string;
	nodeName: string;
	nodeType: string;
	category: string | null;
	description: string | null;
	iconUrl: string | null;
	version: string | null;
	source: 'builtin' | 'platform' | 'thirdParty' | 'custom';
	needsConfig: boolean;
	isConfigured: boolean;
}
```

### 2.5 æ•°æ®æµé—®é¢˜å›¾è¡¨

```
åç«¯APIè¿”å› (âœ… å®Œæ•´æ•°æ®)
    |
    | { source: 'platform', nodeName: 'GitHub', ... }
    â†“
getAvailableNodes() (âœ… æ­£ç¡®æ¥æ”¶)
    |
    | æ•°æ®åŒ…å«sourceå­—æ®µ
    â†“
convertAvailableNodeToDescription() (âš ï¸ æ·»åŠ sourceä½†å¯èƒ½ä¸¢å¤±)
    |
    | Object.assign(nodeDescription, { source })
    â†“
setNodeTypes() (âŒ groupNodeTypesByNameAndTypeå¯èƒ½åˆ é™¤source)
    |
    | nodeTypes.valueå­˜å‚¨
    â†“
allLatestNodeTypes computed (âŒ sourceæœªæ­£ç¡®ä¿ç•™)
    |
    | visibleNodeTypes 
    â†“
NodeItem.vue (âŒ æ— æ³•è·å–sourceä¿¡æ¯æ˜¾ç¤ºBadge)
```

---

## 3. å·¥ä½œæµç¼–è¾‘å™¨é›†æˆ

### 3.1 èŠ‚ç‚¹æ·»åŠ æµç¨‹

**æ”¯æŒçš„åŠŸèƒ½ï¼š**

1. **æ‹–æ‹½æ·»åŠ ** âœ…
   - NodeCreator.vue ä¸­çš„ onDrop å¤„ç†ï¼ˆç¬¬95è¡Œï¼‰
   - æ”¯æŒæ‹–æ‹½æ•°æ®ä¼ é€’

2. **ç‚¹å‡»æ·»åŠ ** âœ…
   - NodeItem.vue ä¸­çš„ç‚¹å‡»äº‹ä»¶å¤„ç†

3. **æœç´¢æ·»åŠ ** âœ…
   - SearchBar.vue å’Œæœç´¢é€»è¾‘

### 3.2 èŠ‚ç‚¹é…ç½®é¢æ¿

**ç°çŠ¶ï¼š**
- ä½¿ç”¨ NDV (Node Detail View) ç»„ä»¶
- ä½ç½®ï¼š`packages/frontend/editor-ui/src/features/ndv/`
- æ”¯æŒåŠ¨æ€å‚æ•°åŠ è½½

**ç¼ºå¤±çš„èŠ‚ç‚¹æ¥æºä¿¡æ¯æ˜¾ç¤ºï¼š**
```vue
<!-- åº”è¯¥åœ¨NDVä¸­æ˜¾ç¤º -->
<div class="node-header">
	<h1>{{ nodeType.displayName }}</h1>
	<!-- âŒ ç¼ºå°‘è¿™ä¸ªBadge -->
	<span v-if="nodeSource === 'platform'" class="badge badge-platform">å¹³å°èŠ‚ç‚¹</span>
	<span v-if="nodeSource === 'custom'" class="badge badge-custom">è‡ªå®šä¹‰èŠ‚ç‚¹</span>
</div>
```

### 3.3 èŠ‚ç‚¹æ‰§è¡Œç»“æœæ˜¾ç¤º

**ç°çŠ¶ï¼š** âœ… å·²å®Œæ•´å®ç°
- æ‰§è¡Œå†å²æ˜¾ç¤º
- è¾“å‡ºé¢æ¿æ˜¾ç¤º
- é”™è¯¯å¤„ç†

**ç¼ºå¤±ï¼š** 
- æ‰§è¡Œæˆæœ¬æ˜¾ç¤ºï¼ˆæœªå®ç°ï¼‰
- èŠ‚ç‚¹è®¡è´¹ä¿¡æ¯å±•ç¤ºï¼ˆæœªå®ç°ï¼‰

---

## 4. èŠ‚ç‚¹ä»·æ ¼ä¸è®¡è´¹

### 4.1 ä»·æ ¼åŠŸèƒ½ç¼ºå¤±æƒ…å†µ

**åç«¯å®ç°çŠ¶æ€ï¼š**
```
PlatformNodeService (âœ“ å­˜åœ¨pricingConfigå­—æ®µ)
CustomNodeService (âœ“ å­˜åœ¨isBillableå­—æ®µ)
AvailableNodesController (âš ï¸ needsConfig = isBillable)
```

**å‰ç«¯å®ç°çŠ¶æ€ï¼š**
```
AvailableNodeæ¥å£ (âœ— æ— priceå­—æ®µ)
nodeTypes.store.ts (âœ— æ— ä»·æ ¼å¤„ç†)
NodeItem.vue (âœ— æ— ä»·æ ¼æ˜¾ç¤º)
WorkflowEditor (âœ— æ— æˆæœ¬ä¼°ç®—)
ExecutionPanel (âœ— æ— æˆæœ¬æ˜¾ç¤º)
```

### 4.2 ç¼ºå¤±çš„å®ç°

#### æ¥å£å®šä¹‰ç¼ºå¤±
```typescript
// packages/frontend/editor-ui/src/app/api/available-nodes.api.ts
// âŒ AvailableNodeæ¥å£ä¸­ç¼ºå°‘ä»·æ ¼å­—æ®µ
export interface AvailableNode {
	// ç°æœ‰å­—æ®µ...
	// âŒ ç¼ºå°‘ï¼š
	// pricingModel?: 'free' | 'per-call' | 'per-usage';
	// pricePerCall?: number;
	// priceCurrency?: string;
	// estimatedMonthlyPrice?: number;
}
```

#### Storeå¤„ç†ç¼ºå¤±
```typescript
// packages/frontend/editor-ui/src/app/stores/nodeTypes.store.ts
// âŒ convertAvailableNodeToDescriptionä¸­ç¼ºå°‘ä»·æ ¼å¤„ç†
const convertAvailableNodeToDescription = (availableNode: AvailableNode) => {
	// ...
	// âŒ ç¼ºå°‘ï¼š
	// Object.assign(nodeDescription, {
	//   pricingModel: availableNode.pricingModel,
	//   pricePerCall: availableNode.pricePerCall,
	// });
};
```

#### UIæ˜¾ç¤ºç¼ºå¤±
```vue
<!-- packages/frontend/editor-ui/src/features/shared/nodeCreator/components/ItemTypes/NodeItem.vue -->
<!-- âŒ å®Œå…¨æ— ä»·æ ¼æ˜¾ç¤º -->
<template>
	<div class="node-item">
		<NodeIcon />
		<div>{{ nodeType.displayName }}</div>
		<!-- âŒ ç¼ºå°‘ï¼š<PriceTag v-if="nodeType.price" :price="nodeType.price" /> -->
	</div>
</template>
```

#### æˆæœ¬ä¼°ç®—ç¼ºå¤±
```typescript
// âŒ å®Œå…¨ç¼ºå¤±çš„åŠŸèƒ½ï¼š
// 1. å·¥ä½œæµæˆæœ¬ä¼°ç®—
// 2. èŠ‚ç‚¹æ‰§è¡Œæˆæœ¬æ˜¾ç¤º
// 3. æœˆåº¦é¢„ä¼°æˆæœ¬
// 4. è´¦æˆ·ä½™é¢æ£€æŸ¥è­¦å‘Š
```

### 4.3 å·¥ä½œæµç¼–è¾‘å™¨ä¸­çš„ä»·æ ¼æ˜¾ç¤º

**åº”è¯¥åœ¨ä»¥ä¸‹ä½ç½®æ˜¾ç¤ºä»·æ ¼ï¼š**

1. **èŠ‚ç‚¹é€‰æ‹©å™¨** - èŠ‚ç‚¹æ—è¾¹æ˜¾ç¤ºä»·æ ¼æ ‡ç­¾
2. **å·¥ä½œæµç¼–è¾‘å™¨** - èŠ‚ç‚¹ä¸Šæ˜¾ç¤ºé¢„ä¼°æˆæœ¬
3. **å·¥ä½œæµæ‰§è¡Œå‰** - æ˜¾ç¤ºæ€»é¢„ä¼°æˆæœ¬å’Œä½™é¢è­¦å‘Š
4. **æ‰§è¡Œå†è¡¨** - æ˜¾ç¤ºå®é™…æ¶ˆè´¹

---

## 5. å·¥ä½œç©ºé—´åˆ‡æ¢

### 5.1 å·¥ä½œç©ºé—´åˆ‡æ¢æµç¨‹

**å½“å‰å®ç°ï¼š**

```typescript
// packages/frontend/editor-ui/src/features/collaboration/projects/projects.store.ts
const setCurrentProject = (project: Project | null) => {
	currentProject.value = project;  // âœ… è®¾ç½®å½“å‰å·¥ä½œç©ºé—´
};

const currentWorkspaceId = computed(() => currentProjectId.value);
```

### 5.2 å·¥ä½œç©ºé—´åˆ‡æ¢æ—¶çš„èŠ‚ç‚¹åˆ·æ–°

**âŒ ç¼ºå¤±ï¼š** ç›‘å¬å·¥ä½œç©ºé—´å˜åŒ–å¹¶åˆ·æ–°èŠ‚ç‚¹åˆ—è¡¨

```typescript
// âŒ åœ¨nodeTypes.store.tsä¸­ç¼ºå°‘è¿™ä¸ªwatch
import { useProjectsStore } from '@/features/collaboration/projects/projects.store';

// åº”è¯¥è¿™æ ·åšï¼š
const projectsStore = useProjectsStore();
watch(
	() => projectsStore.currentWorkspaceId,
	async (newWorkspaceId) => {
		if (newWorkspaceId) {
			// é‡æ–°åŠ è½½èŠ‚ç‚¹ï¼ˆåŒ…æ‹¬è‡ªå®šä¹‰èŠ‚ç‚¹ï¼‰
			await getNodeTypes();
		}
	},
	{ immediate: true }
);
```

### 5.3 å½“å‰çš„Watchç¼ºå¤±

**åœ¨ä»¥ä¸‹æ–‡ä»¶ä¸­éƒ½ç¼ºå°‘å¯¹å·¥ä½œç©ºé—´å˜åŒ–çš„ç›‘å¬ï¼š**

1. `nodeTypes.store.ts` - æ— Watchç›‘å¬currentWorkspaceId
2. `nodeCreator.store.ts` - æ— Watchç›‘å¬currentWorkspaceId
3. `NodeCreator.vue` - æ— Watchç›‘å¬currentWorkspaceId

### 5.4 å·¥ä½œç©ºé—´éš”ç¦»éªŒè¯

âœ… **å·²æ­£ç¡®éš”ç¦»çš„æ•°æ®ï¼š**
- è‡ªå®šä¹‰èŠ‚ç‚¹ï¼ˆcustom_nodeè¡¨æœ‰workspace_idå¤–é”®ï¼‰
- å·¥ä½œæµï¼ˆworkflowè¡¨æœ‰project_idå¤–é”®ï¼‰
- å·¥ä½œæµæ‰§è¡Œï¼ˆexecutionè¡¨æœ‰project_idå¤–é”®ï¼‰

âŒ **éœ€è¦æ”¹è¿›çš„éš”ç¦»ï¼š**
- èŠ‚ç‚¹é€‰æ‹©å™¨åœ¨å·¥ä½œç©ºé—´åˆ‡æ¢æ—¶æœªåˆ·æ–°
- è‡ªå®šä¹‰èŠ‚ç‚¹åˆ—è¡¨æœªåœ¨å·¥ä½œç©ºé—´åˆ‡æ¢æ—¶é‡æ–°åŠ è½½

---

## ç¼ºå¤±åŠŸèƒ½æ¸…å•

### ä¼˜å…ˆçº§ P0 (é˜»å¡åŠŸèƒ½)

| # | åŠŸèƒ½ | ä½ç½® | ä¼˜å…ˆçº§ | å·¥ä½œé‡ | è¯´æ˜ |
|----|------|------|--------|--------|------|
| 1 | èŠ‚ç‚¹æ¥æºBadgeæ˜¾ç¤º | NodeItem.vue | P0 | 2h | åœ¨èŠ‚ç‚¹é¡¹ä¸­æ˜¾ç¤º[å†…ç½®]/[å¹³å°]/[æˆ‘çš„]æ ‡ç­¾ |
| 2 | Sourceå­—æ®µä¿ç•™ | nodeTypes.store.ts | P0 | 3h | ç¡®ä¿sourceä¿¡æ¯æ­£ç¡®æµå‘UI |
| 3 | å·¥ä½œç©ºé—´åˆ‡æ¢æ—¶åˆ·æ–°èŠ‚ç‚¹ | nodeTypes.store.ts | P0 | 2h | æ·»åŠ Watchç›‘å¬currentWorkspaceId |
| 4 | è‡ªå®šä¹‰èŠ‚ç‚¹åˆ—è¡¨å®Œæ•´æ€§ | AvailableNodesController | P0 | 1h | ç¡®ä¿customèŠ‚ç‚¹è¿”å›å®Œæ•´çš„nodeDefinition |

### ä¼˜å…ˆçº§ P1 (ä¸»è¦åŠŸèƒ½)

| # | åŠŸèƒ½ | ä½ç½® | ä¼˜å…ˆçº§ | å·¥ä½œé‡ | è¯´æ˜ |
|----|------|------|--------|--------|------|
| 5 | èŠ‚ç‚¹ä»·æ ¼å­—æ®µ | APIæ¥å£ | P1 | 2h | åç«¯è¿”å›èŠ‚ç‚¹ä»·æ ¼ä¿¡æ¯ |
| 6 | ä»·æ ¼æ˜¾ç¤ºUI | NodeItem.vue | P1 | 3h | åœ¨èŠ‚ç‚¹é€‰æ‹©å™¨ä¸­æ˜¾ç¤ºä»·æ ¼ |
| 7 | å·¥ä½œæµæˆæœ¬ä¼°ç®— | WorkflowEditor | P1 | 8h | è®¡ç®—å·¥ä½œæµæ€»æˆæœ¬ |
| 8 | æ‰§è¡Œæˆæœ¬æ˜¾ç¤º | ExecutionPanel | P1 | 4h | æ˜¾ç¤ºå®é™…æ¶ˆè´¹å’Œä½™é¢ |

### ä¼˜å…ˆçº§ P2 (å¢å¼ºåŠŸèƒ½)

| # | åŠŸèƒ½ | ä½ç½® | ä¼˜å…ˆçº§ | å·¥ä½œé‡ | è¯´æ˜ |
|----|------|------|--------|--------|------|
| 9 | ä¸‰å±‚èŠ‚ç‚¹Tab | NodeCreator.vue | P2 | 4h | æŒ‰æ¥æºåˆ†ç±»ï¼ˆåŸºç¡€/æ‰©å±•/æˆ‘çš„ï¼‰ |
| 10 | è‡ªå®šä¹‰èŠ‚ç‚¹ä¸Šä¼ å…¥å£ | NodeCreator.vue | P2 | 5h | æä¾›ä¸Šä¼ å’Œç®¡ç†è‡ªå®šä¹‰èŠ‚ç‚¹ç•Œé¢ |
| 11 | èŠ‚ç‚¹å¸‚åœºå±•ç¤º | NodeCreator.vue | P2 | 8h | å±•ç¤ºå¹³å°èŠ‚ç‚¹è¯¦æƒ…å’Œè¯„ä»· |
| 12 | èŠ‚ç‚¹æœç´¢å¢å¼º | SearchBar.vue | P2 | 3h | æ”¯æŒæŒ‰æ¥æºã€ä»·æ ¼ç­‰ç­›é€‰ |

### ä¼˜å…ˆçº§ P3 (æœªæ¥æ”¹è¿›)

| # | åŠŸèƒ½ | ä½ç½® | ä¼˜å…ˆçº§ | å·¥ä½œé‡ | è¯´æ˜ |
|----|------|------|--------|--------|------|
| 13 | èŠ‚ç‚¹æ€§èƒ½ç›‘æ§ | ExecutionPanel | P3 | 6h | æ˜¾ç¤ºèŠ‚ç‚¹æ‰§è¡Œæ—¶é—´å’Œèµ„æºæ¶ˆè€— |
| 14 | èŠ‚ç‚¹ä¾èµ–åˆ†æ | WorkflowAnalyzer | P3 | 5h | åˆ†æèŠ‚ç‚¹é—´ä¾èµ–å’Œå¯è§†åŒ– |
| 15 | èŠ‚ç‚¹é¢„æµ‹æˆæœ¬ | CostEstimator | P3 | 6h | åŸºäºå†å²æ•°æ®é¢„æµ‹æˆæœ¬ |

---

## æ”¹è¿›å»ºè®®

### æ–¹æ¡ˆ1ï¼šå¿«é€Ÿä¿®å¤ (1-2å¤©)

å®ç°P0ä¼˜å…ˆçº§åŠŸèƒ½ï¼Œç¡®ä¿åŸºç¡€èŠ‚ç‚¹ç³»ç»Ÿæ­£å¸¸å·¥ä½œï¼š

```typescript
// æ­¥éª¤1ï¼šä¿®å¤NodeItem.vueä¸­çš„Badgeæ˜¾ç¤º
// åœ¨NodeItem.vueä¸­æ·»åŠ ï¼š
const nodeBadge = computed(() => {
	const source = (props.nodeType as any).source || 'unknown';
	return {
		'builtin': { text: 'å†…ç½®', color: 'info' },
		'platform': { text: 'å¹³å°', color: 'success' },
		'thirdParty': { text: 'ç¬¬ä¸‰æ–¹', color: 'warning' },
		'custom': { text: 'æˆ‘çš„', color: 'primary' },
	}[source];
});

// æ­¥éª¤2ï¼šä¿®å¤nodeTypes.store.tsä¸­çš„sourceä¿ç•™
// ä¿®æ”¹convertAvailableNodeToDescriptionè¿”å›çš„å¯¹è±¡ç»“æ„
// ç¡®ä¿sourceè¢«æ­£ç¡®æ·»åŠ åˆ°nodeDescription

// æ­¥éª¤3ï¼šåœ¨nodeTypes.store.tsä¸­æ·»åŠ Watch
import { watch } from 'vue';
const projectsStore = useProjectsStore();
watch(
	() => projectsStore.currentWorkspaceId,
	async () => { await getNodeTypes(); }
);
```

### æ–¹æ¡ˆ2ï¼šå®Œæ•´åŠŸèƒ½ (2-4å‘¨)

å®ç°P0å’ŒP1ä¼˜å…ˆçº§åŠŸèƒ½ï¼š

**ç¬¬1å‘¨ï¼š** åŸºç¡€å®Œå–„
- ä¿®å¤èŠ‚ç‚¹æ¥æºæ˜¾ç¤º
- æ·»åŠ å·¥ä½œç©ºé—´åˆ‡æ¢åˆ·æ–°
- å®Œå–„èŠ‚ç‚¹æ•°æ®å®Œæ•´æ€§

**ç¬¬2å‘¨ï¼š** ä»·æ ¼ç³»ç»Ÿ
- åç«¯è¿”å›ä»·æ ¼ä¿¡æ¯
- å‰ç«¯ä»·æ ¼UIæ˜¾ç¤º
- åŸºç¡€æˆæœ¬è®¡ç®—

**ç¬¬3-4å‘¨ï¼š** é«˜çº§åŠŸèƒ½
- å·¥ä½œæµæˆæœ¬ä¼°ç®—
- æ‰§è¡Œå†è¡¨æˆæœ¬æ˜¾ç¤º
- ä¸‰å±‚èŠ‚ç‚¹Tabé‡æ„

### æ–¹æ¡ˆ3ï¼šæ¸è¿›å¼æ¼”è¿› (æŒ‰æœˆæ¨è¿›)

- **11æœˆï¼š** ä¿®å¤P0 + ä»·æ ¼å­—æ®µ
- **12æœˆï¼š** ä»·æ ¼UI + åŸºç¡€æˆæœ¬ä¼°ç®—
- **1æœˆï¼š** é«˜çº§åŠŸèƒ½ + UIä¼˜åŒ–

---

## è¯¦ç»†å®ç°å»ºè®®

### å»ºè®®1ï¼šä¿®å¤Sourceä¿¡æ¯æµ

**æ–‡ä»¶ï¼š** `packages/frontend/editor-ui/src/app/stores/nodeTypes.store.ts`

**ä¿®æ”¹å†…å®¹ï¼š**

```typescript
// ç¬¬336-387è¡Œçš„convertAvailableNodeToDescriptionéœ€è¦æ”¹è¿›
const convertAvailableNodeToDescription = (
	availableNode: AvailableNode,
): INodeTypeDescription | null => {
	// ... ç°æœ‰ä»£ç  ...
	
	// å…³é”®ï¼šå¿…é¡»ä¿ç•™sourceå­—æ®µï¼
	const nodeDescription: any = {
		// ... å…¶ä»–å­—æ®µ ...
		source: availableNode.source,  // âœ… æ˜ç¡®ä¿ç•™source
		pricingModel: availableNode.pricingModel,  // æ–°å¢
		pricePerCall: availableNode.pricePerCall,   // æ–°å¢
	};
	
	return nodeDescription as INodeTypeDescription;
};

// ç¡®ä¿setNodeTypesä¿ç•™è¿™äº›å­—æ®µ
const setNodeTypes = (newNodeTypes: INodeTypeDescription[] = []) => {
	const groupedNodeTypes = groupNodeTypesByNameAndType(newNodeTypes);
	
	// âœ… éå†ç¡®ä¿sourceè¢«ä¿ç•™
	const newGroupedTypes = Object.entries(groupedNodeTypes).reduce(
		(acc, [name, versions]) => {
			acc[name] = Object.entries(versions).reduce(
				(versionAcc, [version, nodeType]) => {
					// ä¿ç•™æ‰€æœ‰è‡ªå®šä¹‰å­—æ®µ
					versionAcc[Number(version)] = {
						...nodeType,
						source: (nodeType as any).source,  // æ˜ç¡®ä¿ç•™
						pricingModel: (nodeType as any).pricingModel,
						pricePerCall: (nodeType as any).pricePerCall,
					};
					return versionAcc;
				},
				{} as Record<number, INodeTypeDescription>,
			);
			return acc;
		},
		{} as NodeTypesByTypeNameAndVersion,
	);
	
	nodeTypes.value = newGroupedTypes;
};
```

### å»ºè®®2ï¼šæ·»åŠ å·¥ä½œç©ºé—´åˆ‡æ¢åˆ·æ–°

**æ–‡ä»¶ï¼š** `packages/frontend/editor-ui/src/app/stores/nodeTypes.store.ts`

```typescript
// åœ¨returnè¯­å¥å‰æ·»åŠ ï¼š
import { watch } from 'vue';
import { useProjectsStore } from '@/features/collaboration/projects/projects.store';

// ç›‘å¬å·¥ä½œç©ºé—´å˜åŒ–
const projectsStore = useProjectsStore();
watch(
	() => projectsStore.currentWorkspaceId,
	async (newWorkspaceId) => {
		if (newWorkspaceId) {
			console.log('[nodeTypes.store] Workspace changed, reloading nodes...');
			// æ¸…é™¤ç¼“å­˜ï¼Œé‡æ–°åŠ è½½èŠ‚ç‚¹
			await getNodeTypes();
		}
	},
	{ immediate: false }  // é¿å…åˆå§‹åŒ–æ—¶é‡å¤åŠ è½½
);
```

### å»ºè®®3ï¼šå®ç°NodeItemä¸­çš„Badgeæ˜¾ç¤º

**æ–‡ä»¶ï¼š** `packages/frontend/editor-ui/src/features/shared/nodeCreator/components/ItemTypes/NodeItem.vue`

```vue
<template>
	<div :class="['node-item', { 'node-item--active': active }]">
		<NodeIcon :node="nodeType" />
		<div class="node-item__content">
			<div class="node-item__header">
				<span class="node-item__name">{{ nodeType.displayName }}</span>
				<!-- âœ… æ·»åŠ æ¥æºBadge -->
				<span v-if="nodeBadge" :class="['badge', `badge--${nodeBadge.type}`]">
					{{ nodeBadge.text }}
				</span>
			</div>
			<p v-if="description" class="node-item__description">{{ description }}</p>
			<!-- âœ… æ·»åŠ ä»·æ ¼æ˜¾ç¤º -->
			<div v-if="nodePrice" class="node-item__price">
				Â¥{{ nodePrice }} / æ¬¡
			</div>
		</div>
	</div>
</template>

<script setup lang="ts">
import { computed } from 'vue';

const nodeBadge = computed(() => {
	const source = (props.nodeType as any).source || 'unknown';
	const badgeMap = {
		'builtin': { text: 'å†…ç½®', type: 'default' },
		'platform': { text: 'å¹³å°', type: 'success' },
		'thirdParty': { text: 'ç¬¬ä¸‰æ–¹', type: 'info' },
		'custom': { text: 'æˆ‘çš„', type: 'warning' },
	};
	return badgeMap[source as keyof typeof badgeMap] || null;
});

const nodePrice = computed(() => {
	const price = (props.nodeType as any).pricePerCall;
	return price ? price.toFixed(4) : null;
});
</script>

<style scoped>
.badge {
	font-size: var(--font-size--2xs);
	padding: var(--spacing--2xs) var(--spacing--xs);
	border-radius: var(--radius);
	font-weight: var(--font-weight--bold);
}

.badge--default {
	background: var(--color--foreground--tint-1);
	color: var(--color--text);
}

.badge--success {
	background: var(--color--success--tint-3);
	color: var(--color--success--shade-1);
}

.badge--warning {
	background: var(--color--warning--tint-2);
	color: var(--color--warning--shade-1);
}

.node-item__price {
	font-size: var(--font-size--2xs);
	color: var(--color--text--tint-1);
	margin-top: var(--spacing--2xs);
}
</style>
```

### å»ºè®®4ï¼šå®Œå–„AvailableNodesController

**æ–‡ä»¶ï¼š** `/packages/cli/src/controllers/available-nodes.controller.ts`

```typescript
// ç¡®ä¿å¹³å°èŠ‚ç‚¹è¿”å›å®Œæ•´ä¿¡æ¯
...platformNodes.map((node) => ({
	nodeKey: node.nodeKey,
	nodeName: node.nodeName,
	nodeType: node.nodeType,
	category: node.category,
	description: node.description,
	iconUrl: node.iconUrl,
	version: node.version,
	source: node.sourceType === 'third_party' ? 'thirdParty' : 'platform',
	needsConfig: node.isBillable || false,
	// âœ… æ·»åŠ è¿™äº›å­—æ®µ
	pricingModel: node.pricingConfig?.model,  // 'free' | 'per-call' | 'per-usage'
	pricePerCall: node.pricingConfig?.pricePerCall,
	priceCurrency: node.pricingConfig?.currency || 'CNY',
	nodeDefinition: node.nodeDefinition,  // å®Œæ•´çš„èŠ‚ç‚¹å®šä¹‰
})...
```

### å»ºè®®5ï¼šæ·»åŠ NodeCreator Tabç»“æ„

**æ–‡ä»¶ï¼š** `packages/frontend/editor-ui/src/features/shared/nodeCreator/components/NodeCreator.vue`

```vue
<template>
	<div class="node-creator">
		<n8n-tabs v-model="activeTab" class="node-creator-tabs">
			<!-- Tab 1: åŸºç¡€èŠ‚ç‚¹ï¼ˆå†…ç½®ï¼Œçº¦53ä¸ªï¼‰ -->
			<n8n-tab-pane :label="t('nodeCreator.tab.builtin')" name="builtin">
				<NodesListPanel :nodes="filteredBuiltinNodes" />
			</n8n-tab-pane>

			<!-- Tab 2: æ‰©å±•èŠ‚ç‚¹ï¼ˆå¹³å° + ç¬¬ä¸‰æ–¹ï¼‰ -->
			<n8n-tab-pane :label="t('nodeCreator.tab.extension')" name="extension">
				<div class="extension-section">
					<h3>{{ t('nodeCreator.section.platformOfficial') }}</h3>
					<NodesListPanel :nodes="filteredPlatformNodes" />
					
					<h3>{{ t('nodeCreator.section.thirdParty') }}</h3>
					<NodesListPanel :nodes="filteredThirdPartyNodes" />
				</div>
			</n8n-tab-pane>

			<!-- Tab 3: æˆ‘çš„èŠ‚ç‚¹ï¼ˆå·¥ä½œç©ºé—´ç§æœ‰ï¼‰ -->
			<n8n-tab-pane :label="t('nodeCreator.tab.custom')" name="custom">
				<NodesListPanel v-if="customNodes.length" :nodes="filteredCustomNodes" />
				<n8n-empty v-else :description="t('nodeCreator.empty.custom')">
					<n8n-button @click="showUploadDialog = true" icon="plus">
						{{ t('nodeCreator.button.uploadNode') }}
					</n8n-button>
				</n8n-empty>
			</n8n-tab-pane>
		</n8n-tabs>
	</div>
</template>

<script setup lang="ts">
import { computed, ref } from 'vue';
import { useNodeTypesStore } from '@/app/stores/nodeTypes.store';
import { useI18n } from '@n8n/i18n';

const nodeTypesStore = useNodeTypesStore();
const { t } = useI18n();
const activeTab = ref('builtin');

const builtinNodes = computed(() =>
	Object.values(nodeTypesStore.nodeTypes)
		.flatMap((versions) => Object.values(versions))
		.filter((node) => (node as any).source === 'builtin')
);

const platformNodes = computed(() =>
	Object.values(nodeTypesStore.nodeTypes)
		.flatMap((versions) => Object.values(versions))
		.filter((node) => (node as any).source === 'platform')
);

const customNodes = computed(() =>
	Object.values(nodeTypesStore.nodeTypes)
		.flatMap((versions) => Object.values(versions))
		.filter((node) => (node as any).source === 'custom')
);
</script>
```

---

## ä»£ç ä½ç½®å¯¼èˆª

### æ ¸å¿ƒæ–‡ä»¶æ¸…å•

**å‰ç«¯æ ¸å¿ƒæ–‡ä»¶ï¼š**
```
packages/frontend/editor-ui/src/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ stores/nodeTypes.store.ts (342è¡Œ) â­ èŠ‚ç‚¹æ•°æ®ç®¡ç†
â”‚   â”œâ”€â”€ api/available-nodes.api.ts (123è¡Œ) â­ APIè°ƒç”¨
â”‚   â””â”€â”€ components/WorkspaceSwitcher.vue (100+è¡Œ)
â””â”€â”€ features/shared/nodeCreator/
    â”œâ”€â”€ components/
    â”‚   â”œâ”€â”€ NodeCreator.vue (ä¸»å®¹å™¨)
    â”‚   â”œâ”€â”€ Panel/NodesListPanel.vue (èŠ‚ç‚¹åˆ—è¡¨)
    â”‚   â””â”€â”€ ItemTypes/NodeItem.vue (â­ éœ€è¦Badge) (80+è¡Œ)
    â”œâ”€â”€ nodeCreator.store.ts (200+è¡Œ)
    â””â”€â”€ composables/
        â”œâ”€â”€ useActionsGeneration.ts
        â””â”€â”€ useDynamicAINodes.ts
```

**åç«¯æ ¸å¿ƒæ–‡ä»¶ï¼š**
```
packages/cli/src/controllers/
â””â”€â”€ available-nodes.controller.ts (277è¡Œ) â­ APIå®ç°

packages/cli/src/services/
â”œâ”€â”€ platform-node.service.ts (å¹³å°èŠ‚ç‚¹)
â”œâ”€â”€ custom-node.service.ts (è‡ªå®šä¹‰èŠ‚ç‚¹)
â””â”€â”€ user-node-config.service.ts (ç”¨æˆ·é…ç½®)
```

**å…³é”®ç±»å‹æ–‡ä»¶ï¼š**
```
packages/frontend/@n8n/rest-api-client/src/api/
â””â”€â”€ available-nodes.api.ts (123è¡Œ) â­ æ¥å£å®šä¹‰

packages/@n8n/api-types/src/
â””â”€â”€ dto/available-nodes.dto.ts (å¾…åˆ›å»º)
```

---

## è´¨é‡æ£€æŸ¥æ¸…å•

### ä»£ç å®¡æŸ¥æ£€æŸ¥é¡¹

- [ ] Sourceå­—æ®µåœ¨æ•´ä¸ªæ•°æ®æµä¸­è¢«æ­£ç¡®ä¿ç•™
- [ ] NodeItem.vue ä¸­æ˜¾ç¤ºäº†èŠ‚ç‚¹æ¥æºBadge
- [ ] nodeTypes.store.ts ä¸­æœ‰Watchç›‘å¬currentWorkspaceId
- [ ] å·¥ä½œç©ºé—´åˆ‡æ¢æ—¶èƒ½æ­£ç¡®åˆ·æ–°è‡ªå®šä¹‰èŠ‚ç‚¹åˆ—è¡¨
- [ ] AvailableNodesController è¿”å›äº†å®Œæ•´çš„nodeDefinition
- [ ] æ‰€æœ‰æ–°å¢å­—æ®µéƒ½æœ‰TypeScriptç±»å‹å®šä¹‰
- [ ] ä½¿ç”¨äº†i18nè¿›è¡Œæ–‡æœ¬å›½é™…åŒ–
- [ ] ä½¿ç”¨äº†CSSå˜é‡è¿›è¡Œæ ·å¼ï¼ˆä¸æ˜¯ç¡¬ç¼–ç é¢œè‰²ï¼‰

### æµ‹è¯•è¦†ç›–

- [ ] å•å…ƒæµ‹è¯•ï¼šnodeTypes.store.tsçš„getNodeTypesæ–¹æ³•
- [ ] å•å…ƒæµ‹è¯•ï¼šconvertAvailableNodeToDescription
- [ ] E2Eæµ‹è¯•ï¼šèŠ‚ç‚¹é€‰æ‹©å™¨æ˜¾ç¤ºBadge
- [ ] E2Eæµ‹è¯•ï¼šå·¥ä½œç©ºé—´åˆ‡æ¢ååˆ·æ–°èŠ‚ç‚¹åˆ—è¡¨
- [ ] E2Eæµ‹è¯•ï¼šè‡ªå®šä¹‰èŠ‚ç‚¹æ­£ç¡®éš”ç¦»

### æ€§èƒ½æ£€æŸ¥

- [ ] èŠ‚ç‚¹åˆ—è¡¨åŠ è½½æ—¶é—´ < 500ms
- [ ] å·¥ä½œç©ºé—´åˆ‡æ¢å“åº”æ—¶é—´ < 1s
- [ ] æœç´¢èŠ‚ç‚¹å“åº”æ—¶é—´ < 200ms
- [ ] å†…å­˜å ç”¨ < 50MB

---

## é™„å½•

### A. è®¾è®¡æ–‡æ¡£å‚è€ƒ

ç›¸å…³è®¾è®¡æ–‡æ¡£ä½ç½®ï¼š
- `æ”¹é€ æ–¹æ¡ˆæ–‡æ¡£/07-å‰ç«¯å®ç°.md` - èŠ‚ç‚¹é€‰æ‹©å™¨è®¾è®¡
- `æ”¹é€ æ–¹æ¡ˆæ–‡æ¡£/04-èŠ‚ç‚¹æ¶æ„.md` - ä¸‰å±‚èŠ‚ç‚¹æ¶æ„è¯´æ˜
- `æ”¹é€ æ–¹æ¡ˆæ–‡æ¡£/05-AIæœåŠ¡æ¶æ„.md` - AIèŠ‚ç‚¹å’Œè®¡è´¹ç³»ç»Ÿ

### B. å‘½ä»¤å‚è€ƒ

**å¼€å‘å‘½ä»¤ï¼š**
```bash
# å¼€å‘å‰ç«¯
pnpm dev:fe:main

# è¿è¡Œå‰ç«¯æµ‹è¯•
pnpm test packages/frontend/editor-ui

# ç±»å‹æ£€æŸ¥
pnpm typecheck

# ä»£ç lint
pnpm lint
```

**è°ƒè¯•å‘½ä»¤ï¼š**
```bash
# æŸ¥çœ‹èŠ‚ç‚¹StoreçŠ¶æ€
console.log(nodeTypesStore.$state)

# æŸ¥çœ‹nodesBySource
console.log(nodeTypesStore.nodesBySource)

# æŸ¥çœ‹visibleNodeTypes
console.log(nodeTypesStore.visibleNodeTypes)
```

### C. è°ƒè¯•æŠ€å·§

**åœ¨nodeTypes.store.tsä¸­æ·»åŠ è°ƒè¯•æ—¥å¿—ï¼š**
```typescript
// ç¬¬99-110è¡Œå·²æœ‰ç¤ºä¾‹
if (process.env.NODE_ENV === 'development') {
	const sampleNode = result.find((n) => n.name.includes('filter'));
	if (sampleNode) {
		console.log('[allLatestNodeTypes] Sample node:', {
			name: sampleNode.name,
			source: (sampleNode as any).source,
		});
	}
}
```

**åœ¨æµè§ˆå™¨DevToolsä¸­æ£€æŸ¥ï¼š**
```javascript
// åœ¨Chrome Consoleä¸­è¿è¡Œ
import { useNodeTypesStore } from '@/app/stores/nodeTypes.store';
const store = useNodeTypesStore();

// æ£€æŸ¥æ‰€æœ‰èŠ‚ç‚¹
Object.values(store.nodeTypes).flatMap(v => Object.values(v))
	.forEach(n => console.log(n.name, (n as any).source));

// æ£€æŸ¥æŒ‰æºåˆ†ç±»
for (const [source, nodes] of store.nodesBySource) {
	console.log(`${source}: ${nodes.length} nodes`);
}
```

---

**æŠ¥å‘Šå®Œæˆæ—¶é—´ï¼š** 2025-11-11  
**æœ€åæ›´æ–°ï¼š** 2025-11-11  
**ä¸‹ä¸€æ­¥å®¡æ ¸è®¡åˆ’ï¼š** 2025-11-15
