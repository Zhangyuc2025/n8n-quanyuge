# å‡­è¯ç³»ç»Ÿç§»é™¤ - å·¥ä½œæ€»ç»“

> **æ—¥æœŸ:** 2025-01-10
> **çŠ¶æ€:** ğŸ”„ è¿›è¡Œä¸­ (70%)
> **ä¸‹æ¬¡ç»§ç»­æ—¶é—´:** å¾…å®š

---

## ğŸ“‹ å·¥ä½œèƒŒæ™¯

åŸºäºèŠ‚ç‚¹æ¶æ„è°ƒæ•´ï¼ˆåˆ é™¤ç¬¬ 4 å±‚ç”¨æˆ· npm å®‰è£…åŠŸèƒ½ï¼‰ï¼Œå‡­è¯ç³»ç»Ÿéœ€è¦å®Œå…¨ç§»é™¤ï¼š
- èŠ‚ç‚¹ä¸å†éœ€è¦ç”¨æˆ·è‡ªå·±é…ç½®å‡­è¯
- AI èŠ‚ç‚¹æ”¹ä¸ºå¹³å°ç»Ÿä¸€æ‰˜ç®¡ API Key
- ç®€åŒ–ç”¨æˆ·ä½¿ç”¨æµç¨‹

---

## âœ… å·²å®Œæˆå·¥ä½œ (70%)

### 1. åç«¯å‡­è¯ä»£ç åˆ é™¤ âœ…

**åˆ é™¤çš„æ–‡ä»¶ (11+):**
- âœ… Entity: `CredentialsEntity.ts`
- âœ… Repository: `credentials.repository.ts`
- âœ… Service: `credentials.service.ts`, `credentials.ee.service.ts`
- âœ… Controller: `credentials.controller.ts`, `credentials.ee.controller.ts`
- âœ… DTO: 5 ä¸ªå‡­è¯ç›¸å…³ DTO æ–‡ä»¶

**ä¿®æ”¹çš„æ–‡ä»¶:**
- âœ… `Project.ts` - ç§»é™¤ credentials å…³ç³»
- âœ… `types-db.ts` - ç§»é™¤ CredentialsEntity å¼•ç”¨å’Œç±»å‹
- âœ… è¿ç§»ç´¢å¼•æ–‡ä»¶ (MySQL/PostgreSQL/SQLite) - ç§»é™¤å‡­è¯è¿ç§»å¼•ç”¨

**å¤‡ä»½çš„æ–‡ä»¶:**
- âœ… `@n8n/db-backup/` - 4 ä¸ªå‡­è¯è¿ç§»æ–‡ä»¶
- âœ… `packages/nodes-base-backup/` - iCall æ“ä½œã€sendAndWait å·¥å…·

### 2. å‰ç«¯å‡­è¯ä»£ç åˆ é™¤ âœ…

**åˆ é™¤çš„ç›®å½•:**
- âœ… `features/credentials/` (54 ä¸ªæ–‡ä»¶)
  - Store, API, Views, Components, Types, Constants

### 3. æ„å»ºé”™è¯¯ä¿®å¤ (éƒ¨åˆ†å®Œæˆ)

**å·²ä¿®å¤çš„åŒ…:**
- âœ… `@n8n/api-types` - ç§»é™¤å‡­è¯ DTO å¯¼å‡º
- âœ… `@n8n/core` - ç§»é™¤å‡­è¯é”™è¯¯ç±»å’Œä¸Šä¸‹æ–‡
- âœ… `@n8n/db` - ç§»é™¤ CredentialsEntity å¼•ç”¨å’Œç±»å‹
- âœ… `@n8n/db` - ç§»é™¤å‡­è¯è¿ç§»æ–‡ä»¶å¼•ç”¨

**å·²ä¿®å¤çš„å‰ç«¯æ–‡ä»¶:**
- âœ… `ui.store.ts` - ç§»é™¤å‡­è¯æ¨¡æ€æ¡†å¸¸é‡å’Œå‡½æ•°
- âœ… `projects.store.ts` - ç§»é™¤å‡­è¯ API è°ƒç”¨å’Œç±»å‹å®šä¹‰
- âœ… `projects.routes.ts` - ç§»é™¤å‡­è¯è·¯ç”±é…ç½®

---

## ğŸš§ è¿›è¡Œä¸­çš„å·¥ä½œ (30%)

### å½“å‰æ­£åœ¨ä¿®å¤çš„æ–‡ä»¶

**1. `useCanvasOperations.ts` ğŸ”„**

**ä½ç½®:** `packages/frontend/editor-ui/src/app/composables/useCanvasOperations.ts`

**é—®é¢˜:**
- å¯¼å…¥äº† `IUsedCredential` ç±»å‹ (ç¬¬ 16 è¡Œ)
- å¯¼å…¥äº† `useCredentialsStore` (ç¬¬ 47 è¡Œ)
- ä½¿ç”¨äº† `credentialsStore` å®ä¾‹ (ç¬¬ 167 è¡Œ)
- å¤šå¤„å‡­è¯ç›¸å…³é€»è¾‘ (~10 å¤„å¼•ç”¨)

**éœ€è¦ä¿®æ”¹çš„åœ°æ–¹:**
1. ç§»é™¤å‡­è¯ç±»å‹å¯¼å…¥
2. ç§»é™¤å‡­è¯ store å¯¼å…¥å’Œåˆå§‹åŒ–
3. ç®€åŒ–æˆ–ç§»é™¤å‡­è¯ç›¸å…³é€»è¾‘ï¼ˆæ£€æŸ¥ã€è¿‡æ»¤ã€éªŒè¯ç­‰ï¼‰

**å¤æ‚åº¦:** é«˜ - è¯¥æ–‡ä»¶çº¦ 2200+ è¡Œï¼Œæ¶‰åŠå·¥ä½œæµç”»å¸ƒæ ¸å¿ƒæ“ä½œ

---

## â³ å¾…å¤„ç†å·¥ä½œ

### 1. ç»§ç»­ä¿®å¤å‰ç«¯æ–‡ä»¶

**ä¼˜å…ˆçº§ P0:**

| æ–‡ä»¶ | é—®é¢˜ | é¢„è®¡å·¥æ—¶ |
|------|------|---------|
| `useCanvasOperations.ts` | ~10 å¤„å‡­è¯å¼•ç”¨ | 2-3 å°æ—¶ |
| `nodeTypes.store.ts` | ~5 å¤„å‡­è¯å¼•ç”¨ | 1-2 å°æ—¶ |

**ä¼˜å…ˆçº§ P1 (å¾…æ‰«æ):**

æ ¹æ®æ„å»ºé”™è¯¯æç¤ºï¼Œè¿˜å¯èƒ½æœ‰å…¶ä»–æ–‡ä»¶å¼•ç”¨å‡­è¯ï¼š
- `credentialOnlyNodes` ç›¸å…³æ–‡ä»¶
- å…¶ä»– composables æ–‡ä»¶
- å…¶ä»– stores æ–‡ä»¶

### 2. åç«¯æ¸…ç†

**å¾…å¤„ç†é¡¹:**
- [ ] ç§»é™¤ CLI åŒ…ä¸­çš„å‡­è¯ç›¸å…³ä¸­é—´ä»¶
- [ ] ç§»é™¤å‡­è¯ç›¸å…³çš„ API ç«¯ç‚¹æ³¨å†Œ
- [ ] æ£€æŸ¥å¹¶ç§»é™¤å…¶ä»–å‡­è¯å¼•ç”¨

### 3. æµ‹è¯•éªŒè¯

**æ„å»ºæµ‹è¯•:**
- [ ] `pnpm build` æ— é”™è¯¯
- [ ] æ‰€æœ‰åŒ…ç±»å‹æ£€æŸ¥é€šè¿‡
- [ ] å‰ç«¯æ„å»ºæˆåŠŸ

**åŠŸèƒ½æµ‹è¯•:**
- [ ] å·¥ä½œæµåˆ›å»º/ç¼–è¾‘æ­£å¸¸
- [ ] AI èŠ‚ç‚¹ä½¿ç”¨å¹³å° API Key æ­£å¸¸
- [ ] æ— å‡­è¯ç›¸å…³æŠ¥é”™

---

## ğŸ’¡ ä¸‹æ¬¡å·¥ä½œå»ºè®®

### æ–¹æ¡ˆä¸€ï¼šé€ä¸ªä¿®å¤ï¼ˆç¨³å¦¥ï¼‰

**æ­¥éª¤:**
1. å®Œæˆ `useCanvasOperations.ts` ä¿®å¤
2. å®Œæˆ `nodeTypes.store.ts` ä¿®å¤
3. è¿è¡Œæ„å»ºï¼Œå‘ç°å…¶ä»–é”™è¯¯
4. é€ä¸ªä¿®å¤ç›´åˆ°æ„å»ºæˆåŠŸ

**ä¼˜ç‚¹:** ç¨³å¦¥ï¼Œæ¯ä¸ªæ–‡ä»¶ä¿®å¤åå¯ä»¥éªŒè¯
**ç¼ºç‚¹:** å¯èƒ½éœ€è¦å¤šè½®è¿­ä»£

**é¢„è®¡å·¥æ—¶:** 1-2 å¤©

### æ–¹æ¡ˆäºŒï¼šå…¨å±€æ‰«æï¼ˆé«˜æ•ˆï¼‰

**æ­¥éª¤:**
1. ä½¿ç”¨ Task å·¥å…·æœç´¢æ‰€æœ‰å‡­è¯å¼•ç”¨
2. æ‰¹é‡ä¿®å¤æ‰€æœ‰æ–‡ä»¶
3. ä¸€æ¬¡æ€§æ„å»ºæµ‹è¯•

**ä¼˜ç‚¹:** é«˜æ•ˆï¼Œä¸€æ¬¡æ€§è§£å†³
**ç¼ºç‚¹:** ä¿®æ”¹é¢å¹¿ï¼Œé£é™©è¾ƒé«˜

**é¢„è®¡å·¥æ—¶:** 0.5-1 å¤©

### æ¨èæ–¹æ¡ˆ

**å»ºè®®ä½¿ç”¨æ–¹æ¡ˆä¸€ï¼ˆç¨³å¦¥æ–¹æ¡ˆï¼‰:**
- å…ˆä¿®å¤æ ¸å¿ƒæ–‡ä»¶ `useCanvasOperations.ts`
- è¿è¡Œæ„å»ºæŸ¥çœ‹å‰©ä½™é”™è¯¯
- æ ¹æ®å®é™…é”™è¯¯å†³å®šåç»­ç­–ç•¥

---

## ğŸ“ æŠ€æœ¯è¦ç‚¹

### å‡­è¯ç›¸å…³ä»£ç çš„è¯†åˆ«æ¨¡å¼

**åç«¯:**
- Entity: `CredentialsEntity`, `SharedCredentials`
- Repository: `CredentialsRepository`
- Service: `CredentialsService`
- ç±»å‹: `ICredentials*`, `Credential*`
- å¯¼å…¥è·¯å¾„: `@/credentials/*`, `@/entities/credentials*`

**å‰ç«¯:**
- Store: `useCredentialsStore`, `credentialsStore`
- API: `credentialsApi`, `credentialsEEApi`
- ç±»å‹: `ICredential*`, `Credential*`
- å¯¼å…¥è·¯å¾„: `@/features/credentials/*`
- å¸¸é‡: `CREDENTIAL_*_MODAL_KEY`

### æ›¿ä»£æ–¹æ¡ˆ

**åŸå‡­è¯åŠŸèƒ½ â†’ æ–°æ–¹æ¡ˆ:**
- å‡­è¯ç®¡ç† â†’ å¹³å° AI Provider ç®¡ç†
- èŠ‚ç‚¹å‡­è¯é…ç½® â†’ UserNodeConfig
- å‡­è¯å…±äº« â†’ å·¥ä½œç©ºé—´çº§åˆ«é…ç½®

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [æ”¹é€ æ–¹æ¡ˆ - èŠ‚ç‚¹æ¶æ„](./modules/04-èŠ‚ç‚¹æ¶æ„.md)
- [å®æ–½è®¡åˆ’ - é˜¶æ®µ 5.5](./modules/09-å®æ–½è®¡åˆ’.md#é˜¶æ®µ-55-å‡­è¯ç³»ç»Ÿç§»é™¤)
- [æ•°æ®åº“è®¾è®¡](./modules/03-æ•°æ®åº“è®¾è®¡.md)

---

## ğŸ“Š è¿›åº¦è¿½è¸ª

**æ•´ä½“å®Œæˆåº¦:** 70%

| é˜¶æ®µ | å®Œæˆåº¦ | è¯´æ˜ |
|------|--------|------|
| åç«¯ä»£ç åˆ é™¤ | 100% | âœ… å®Œæˆ |
| å‰ç«¯ä»£ç åˆ é™¤ | 100% | âœ… å®Œæˆ |
| åç«¯æ„å»ºä¿®å¤ | 100% | âœ… å®Œæˆ |
| å‰ç«¯æ„å»ºä¿®å¤ | 50% | ğŸ”„ è¿›è¡Œä¸­ |
| æµ‹è¯•éªŒè¯ | 0% | â³ å¾…å¼€å§‹ |

**é¢„è®¡å‰©ä½™å·¥æ—¶:** 1-2 å¤©

---

**æœ€åæ›´æ–°:** 2025-01-10
**ç»´æŠ¤è€…:** å¼€å‘å›¢é˜Ÿ
